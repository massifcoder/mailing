/**
 * @license
 * (c) Copyright 2023 Grammarly, Inc.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *     http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("react"),t=require("@grammarly/editor-sdk"),n=(e=>e&&"object"==typeof e&&"default"in e?e:{default:e})(e),r=n.default.createContext({});function c(n,r,c){const l=e.useCallback((e=>null==n?void 0:n(new CustomEvent("plugin-error",{detail:e}))),[n]);e.useEffect((()=>{var e;"undefined"!=typeof navigator&&(null!=r&&null!=(null===(e=null==c?void 0:c.current)||void 0===e?void 0:e.ownerDocument.defaultView)&&window!==c.current.ownerDocument.defaultView?t.init_with_packageName("@grammarly/editor-sdk-react",r,void 0,c.current.ownerDocument.defaultView).catch(l):t.init_with_packageName("@grammarly/editor-sdk-react").catch(l))}),null!=c&&null!=r?[c,r]:[])}function l(e){return"function"==typeof e}Object.defineProperty(exports,"init",{enumerable:!0,get:()=>t.init}),exports.Grammarly=t=>{const{clientId:l,config:u,children:o}=t,a=e.useContext(r);return c(),n.default.createElement(r.Provider,{value:{clientId:null!=l?l:a.clientId,config:{...a.config,...u}}},o)},exports.GrammarlyButton=({tonePosition:e,menuPosition:t,className:r,...c})=>n.default.createElement("grammarly-button",{...c,class:r,"tone-position":e,"menu-position":t}),exports.GrammarlyEditorPlugin=u=>{const[o,{clientId:a,config:i,children:s,className:d,...f}]=function(e){const n={},r={...e};return Object.keys(t.callbackToEventName).forEach((t=>{n[t]=e[t],t in r&&delete r[t]})),[n,r]}(u),m=e.useContext(r),g=e.useRef(),v=e.useRef(),E=e.useRef(),p=e.useCallback((e=>{g.current=e,y()}),[]),b=function(t){const[n,r]=e.useState({}),c=e.useCallback((()=>{customElements.whenDefined(t).then((()=>r((e=>({...e,[t]:!0}))))).catch((()=>{}))}),[t]);return e.useEffect(c,[c]),!!n[t]}("grammarly-editor-plugin"),y=e.useCallback((()=>{var e;null!=g.current&&null!=v.current&&b&&g.current.connect(v.current,null!==(e=E.current)&&void 0!==e?e:void 0)}),[b]),k=e.useMemo((()=>({...m.config,...i})),[m.config,i]);return e.useEffect((()=>{g.current&&(g.current.config=k)}),[g,k]),e.useEffect((()=>{if(null==g.current)return;const{current:e}=g,n=[];return Object.keys(t.callbackToEventName).forEach((r=>{const c=o[r],l=t.callbackToEventName[r];null!=c&&(e.addEventListener(l,c),n.push((()=>e.removeEventListener(l,c))))})),()=>n.forEach((e=>e()))}),[...Object.values(o),b,g.current]),c(u.onPluginError,null!=a?a:m.clientId,g),n.default.createElement("grammarly-editor-plugin",{...f,ref:p,clientId:null!=a?a:m.clientId,autodetect:l(s)?"off":"on",class:d},l(s)?s({setEditor:e=>{v.current=e,y()},setViewport:e=>{E.current=e,y()}}):s)};

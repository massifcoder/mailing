/**
 * @license
 * (c) Copyright 2023 Grammarly, Inc.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *     http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import n,{useCallback as e,useEffect as t,useContext as r,useState as o,useRef as c,useMemo as i}from"react";import{init_with_packageName as l,callbackToEventName as u}from"@grammarly/editor-sdk";export{init}from"@grammarly/editor-sdk";const a=n.createContext({});function d(n,r,o){const c=e((e=>null==n?void 0:n(new CustomEvent("plugin-error",{detail:e}))),[n]);t((()=>{var n;"undefined"!=typeof navigator&&(null!=r&&null!=(null===(n=null==o?void 0:o.current)||void 0===n?void 0:n.ownerDocument.defaultView)&&window!==o.current.ownerDocument.defaultView?l("@grammarly/editor-sdk-react",r,void 0,o.current.ownerDocument.defaultView).catch(c):l("@grammarly/editor-sdk-react").catch(c))}),null!=o&&null!=r?[o,r]:[])}const s=e=>{const{clientId:t,config:o,children:c}=e,i=r(a);return d(),n.createElement(a.Provider,{value:{clientId:null!=t?t:i.clientId,config:{...i.config,...o}}},c)},m=({tonePosition:e,menuPosition:t,className:r,...o})=>n.createElement("grammarly-button",{...o,class:r,"tone-position":e,"menu-position":t});function f(n){return"function"==typeof n}const g=l=>{const[s,{clientId:m,config:g,children:v,className:p,...E}]=function(n){const e={},t={...n};return Object.keys(u).forEach((r=>{e[r]=n[r],r in t&&delete t[r]})),[e,t]}(l),h=r(a),w=c(),y=c(),I=c(),k=e((n=>{w.current=n,D()}),[]),b=function(n){const[r,c]=o({}),i=e((()=>{customElements.whenDefined(n).then((()=>c((e=>({...e,[n]:!0}))))).catch((()=>{}))}),[n]);return t(i,[i]),!!r[n]}("grammarly-editor-plugin"),D=e((()=>{var n;null!=w.current&&null!=y.current&&b&&w.current.connect(y.current,null!==(n=I.current)&&void 0!==n?n:void 0)}),[b]),P=i((()=>({...h.config,...g})),[h.config,g]);return t((()=>{w.current&&(w.current.config=P)}),[w,P]),t((()=>{if(null==w.current)return;const{current:n}=w,e=[];return Object.keys(u).forEach((t=>{const r=s[t],o=u[t];null!=r&&(n.addEventListener(o,r),e.push((()=>n.removeEventListener(o,r))))})),()=>e.forEach((n=>n()))}),[...Object.values(s),b,w.current]),d(l.onPluginError,null!=m?m:h.clientId,w),n.createElement("grammarly-editor-plugin",{...E,ref:k,clientId:null!=m?m:h.clientId,autodetect:f(v)?"off":"on",class:p},f(v)?v({setEditor:n=>{y.current=n,D()},setViewport:n=>{I.current=n,D()}}):v)};export{s as Grammarly,m as GrammarlyButton,g as GrammarlyEditorPlugin};
